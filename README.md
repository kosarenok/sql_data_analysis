# PostgreSql and Python data analysis

## TASK 1

Отобрать клиентов по г. Москва с суммарными остатками по клиенту от 20 000 на последнюю дату.

```sql
create table #Клиенты (client_id varchar(1), FIO varchar (255) , Region varchar(50), account_num int) 
insert into #Клиенты values  
('A','Иванов','Москва',111), 
('A','Иванов','Москва',222), 
('B','Петров','Иваново',333), 
('C','Сидоров','Москва',444) 
   
create table #Cчета ([Date] date, Summa_USD money, Account_num int) 
insert into #Cчета values 
('2012-01-01',15000,111), 
('2012-02-01',10000,111), 
('2012-02-01',5000,222), 
('2012-03-01',30000,333), 
('2012-04-01',20000,444)
```

## TASK 2

Таблица #oper хранит информацию о количестве произведенных операций на каждую календарную дату.  
Вывести на каждую дату количества операций, совершенное с начала месяца по указанную дату включительно накопительным итогом.

```sql
create table #oper (date date, cnt int) 
insert into #oper values 
('2019-06-02',     1985), 
('2019-06-03',     1577), 
('2019-06-04',     1597), 
('2019-06-05',     1468), 


('2019-07-06',     82), 
('2019-07-08',     1689), 
('2019-07-09',     1556), 
('2019-07-10',     1480), 
('2019-07-11',     1405), 
('2019-07-12',     1502)
 ```

## TASK 3

Даны месячные срезы сегментов клиентов, нужно получить по каждому клиенту периоды действия каждого сегмента.
  
```sql
create table #segment ([date] date, ClientID varchar(6),SegmentID int) 
insert into #segment values  
('2018-01-31' ,'A11111', 2), 
('2018-02-28' ,'A11111', 2), 
('2018-03-31' ,'A11111', 1), 
('2018-04-30' ,'A11111', 1), 
('2017-11-30' ,'B22222', 1), 
('2017-10-31' ,'B22222', 1), 
('2017-09-30' ,'B22222', 3), 
('2017-09-30' ,'C33333', 1), 
('2017-10-31' ,'C33333', 1) 
```

## TASK 4

На основе таблицы, где хранятся данные об активности клиентов с сентября 2021 года по февраль 2022, провести когортный анализ

Описание полей:

`CLIENT_ID` - идентификатор клиента;

`VALUE_DAY` - отчетная дата;

`DIGITAL_30_CNT` - кол-во входов в мобильное приложение за последние 30 дней на отчетную дату

`TRAN_ACTIVE_30_CNT` - кол-во транзакций в мобильном приложении за последние 30 дней на отчетную дату;

`OPER_ACTIVE_30_CNT` - кол-во операций (транзакции+нефинансовые операции) в мобильном приложении за последние 30 дней на отчетную дату

Постройте визуальное представление удержания клиентов в статусе:

- активных клиентов (наличие строки для клиента на отчетную дату);

- диджитал активных (активных в мобильном приложении: наличие хотя бы одного входа);

- операционно активных;

- транзакционно активных;
